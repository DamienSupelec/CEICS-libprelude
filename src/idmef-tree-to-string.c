
/* Auto-generated by the GenerateIDMEFTreeToStringC package (Sat Dec 13 17:03:59 2003) */

#include "idmef.h"
#include "idmef-util.h"
#include "idmef-tree-wrap.h"
#include "idmef-tree-to-string.h"
#include <stdio.h>
#include <time.h>


static int indent = 0;



static	int to_string_indent(int len, char *buffer, size_t size)
{
	int offset = 0;

	while ( len-- > 0 )
		MY_SNPRINTF(buffer, size, offset, " ");

	return offset;
}



#define to_string_(name, type, format)					\
static int to_string_ ## name( type var, char *buffer, size_t size)	\
{									\
	int offset = 0;							\
									\
	MY_SNPRINTF(buffer, size, offset, format, var);			\
									\
	return offset;							\
}

to_string_(int16, int16_t, "%hd")
to_string_(uint16, uint16_t, "%hu")
to_string_(int32, int32_t, "%d")
to_string_(uint32, uint32_t, "%u")
to_string_(int64, int64_t, "%lld")
to_string_(uint64, uint64_t, "%llu")
to_string_(float, float, "%f")



static	int to_string_string(idmef_string_t *string, char *buffer, size_t size)
{
	const char *s;
	int offset = 0;

	s = idmef_string_get_string(string);

	MY_SNPRINTF(buffer, size, offset, "%s", s ? s : "<empty>");

	return offset;
}



static	int to_string_time(idmef_time_t *t, char *buffer, size_t size)
{
	char _buf[32];
	time_t _time;
	struct tm _tm;
	int offset = 0;

	_time = idmef_time_get_sec(t);

	if ( ! localtime_r(&_time, &_tm) )
		return -1;

	if ( strftime(_buf, sizeof (_buf), "%H:%M:%S %d/%m/%Y", &_tm) == 0 )
		return -1;

	MY_SNPRINTF(buffer, size, offset, "%s (%u.%u)", _buf, idmef_time_get_sec(t), idmef_time_get_usec(t));

	return offset;
}



/* 
 * FIXME: this function assume that data is a string
 */

static	int to_string_data(idmef_data_t *data, char *buffer, size_t size)
{
	int offset = 0;

	MY_SNPRINTF(buffer, size, offset, "%s", idmef_data_get_data(data));

	return offset;
}



int	idmef_additional_data_to_string(idmef_additional_data_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		int i = idmef_additional_data_get_type(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "type: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_additional_data_type_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_additional_data_get_meaning(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "meaning: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_data_t *field;

		field = idmef_additional_data_get_data(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "data: ");
			MY_CONCAT(to_string_data, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_classification_to_string(idmef_classification_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		int i = idmef_classification_get_origin(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "origin: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_classification_origin_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_classification_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_classification_get_url(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "url: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_userid_to_string(idmef_userid_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_userid_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		int i = idmef_userid_get_type(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "type: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_userid_type_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_userid_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "number: ");
	MY_CONCAT(to_string_uint32,
		  idmef_userid_get_number(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	indent -= 8;

	return offset;
}

int	idmef_user_to_string(idmef_user_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_user_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		int i = idmef_user_get_category(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "category: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_user_category_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_userid_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_user_get_next_userid(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "userid(%d):\n", cnt);
			MY_CONCAT(idmef_userid_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_address_to_string(idmef_address_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_address_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		int i = idmef_address_get_category(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "category: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_address_category_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_address_get_vlan_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "vlan_name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "vlan_num: ");
	MY_CONCAT(to_string_uint32,
		  idmef_address_get_vlan_num(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_string_t *field;

		field = idmef_address_get_address(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "address: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_address_get_netmask(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "netmask: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_process_to_string(idmef_process_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_process_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_string_t *field;

		field = idmef_process_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "pid: ");
	MY_CONCAT(to_string_uint32,
		  idmef_process_get_pid(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_string_t *field;

		field = idmef_process_get_path(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "path: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_process_get_next_arg(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "arg(%d): ", cnt);
			MY_CONCAT(to_string_string, elem, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");

			cnt++;
		}
	}

	{
		idmef_string_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_process_get_next_env(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "env(%d): ", cnt);
			MY_CONCAT(to_string_string, elem, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_webservice_to_string(idmef_webservice_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_string_t *field;

		field = idmef_webservice_get_url(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "url: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_webservice_get_cgi(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "cgi: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_webservice_get_http_method(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "http_method: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_webservice_get_next_arg(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "arg(%d): ", cnt);
			MY_CONCAT(to_string_string, elem, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_snmpservice_to_string(idmef_snmpservice_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_string_t *field;

		field = idmef_snmpservice_get_oid(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "oid: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_snmpservice_get_community(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "community: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_snmpservice_get_command(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "command: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_service_to_string(idmef_service_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_service_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_string_t *field;

		field = idmef_service_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "port: ");
	MY_CONCAT(to_string_uint16,
		  idmef_service_get_port(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_string_t *field;

		field = idmef_service_get_portlist(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "portlist: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_service_get_protocol(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "protocol: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	switch ( idmef_service_get_type(ptr) ) {
	case web_service:
		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, ("web:\n"));
		MY_CONCAT(idmef_webservice_to_string,
			  idmef_service_get_web(ptr),
			  buffer, size, offset);
		break;
 
	case snmp_service:
		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, ("snmp:\n"));
		MY_CONCAT(idmef_snmpservice_to_string,
			  idmef_service_get_snmp(ptr),
			  buffer, size, offset);
		break;
 
	default:
		break;
	}

	indent -= 8;

	return offset;
}

int	idmef_node_to_string(idmef_node_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_node_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		int i = idmef_node_get_category(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "category: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_node_category_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_node_get_location(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "location: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_node_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_address_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_node_get_next_address(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "address(%d):\n", cnt);
			MY_CONCAT(idmef_address_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_source_to_string(idmef_source_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_source_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		int i = idmef_source_get_spoofed(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "spoofed: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_spoofed_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_source_get_interface(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "interface: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_node_t *field;

		field = idmef_source_get_node(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "node:\n");
			MY_CONCAT(idmef_node_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_user_t *field;

		field = idmef_source_get_user(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "user:\n");
			MY_CONCAT(idmef_user_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_process_t *field;

		field = idmef_source_get_process(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "process:\n");
			MY_CONCAT(idmef_process_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_service_t *field;

		field = idmef_source_get_service(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "service:\n");
			MY_CONCAT(idmef_service_to_string, field, buffer, size, offset);
		}
	}	

	indent -= 8;

	return offset;
}

int	idmef_file_access_to_string(idmef_file_access_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_userid_t *field;

		field = idmef_file_access_get_userid(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "userid:\n");
			MY_CONCAT(idmef_userid_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_string_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_file_access_get_next_permission(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "permission(%d): ", cnt);
			MY_CONCAT(to_string_string, elem, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_inode_to_string(idmef_inode_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_time_t *field;

		field = idmef_inode_get_change_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "change_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "number: ");
	MY_CONCAT(to_string_uint32,
		  idmef_inode_get_number(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "major_device: ");
	MY_CONCAT(to_string_uint32,
		  idmef_inode_get_major_device(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "minor_device: ");
	MY_CONCAT(to_string_uint32,
		  idmef_inode_get_minor_device(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "c_major_device: ");
	MY_CONCAT(to_string_uint32,
		  idmef_inode_get_c_major_device(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "c_minor_device: ");
	MY_CONCAT(to_string_uint32,
		  idmef_inode_get_c_minor_device(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	indent -= 8;

	return offset;
}

int	idmef_file_to_string(idmef_file_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_file_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		int i = idmef_file_get_category(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "category: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_file_category_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_file_get_fstype(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "fstype: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_file_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_file_get_path(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "path: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_time_t *field;

		field = idmef_file_get_create_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "create_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_time_t *field;

		field = idmef_file_get_modify_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "modify_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_time_t *field;

		field = idmef_file_get_access_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "access_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "data_size: ");
	MY_CONCAT(to_string_uint32,
		  idmef_file_get_data_size(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "disk_size: ");
	MY_CONCAT(to_string_uint32,
		  idmef_file_get_disk_size(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_file_access_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_file_get_next_file_access(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "file_access(%d):\n", cnt);
			MY_CONCAT(idmef_file_access_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	{
		idmef_linkage_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_file_get_next_file_linkage(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "file_linkage(%d):\n", cnt);
			MY_CONCAT(idmef_linkage_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	{
		idmef_inode_t *field;

		field = idmef_file_get_inode(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "inode:\n");
			MY_CONCAT(idmef_inode_to_string, field, buffer, size, offset);
		}
	}	

	indent -= 8;

	return offset;
}

int	idmef_linkage_to_string(idmef_linkage_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		int i = idmef_linkage_get_category(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "category: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_linkage_category_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_linkage_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_linkage_get_path(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "path: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_file_t *field;

		field = idmef_linkage_get_file(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "file:\n");
			MY_CONCAT(idmef_file_to_string, field, buffer, size, offset);
		}
	}	

	indent -= 8;

	return offset;
}

int	idmef_target_to_string(idmef_target_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_target_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		int i = idmef_target_get_decoy(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "decoy: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_spoofed_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_target_get_interface(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "interface: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_node_t *field;

		field = idmef_target_get_node(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "node:\n");
			MY_CONCAT(idmef_node_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_user_t *field;

		field = idmef_target_get_user(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "user:\n");
			MY_CONCAT(idmef_user_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_process_t *field;

		field = idmef_target_get_process(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "process:\n");
			MY_CONCAT(idmef_process_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_service_t *field;

		field = idmef_target_get_service(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "service:\n");
			MY_CONCAT(idmef_service_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_file_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_target_get_next_file(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "file(%d):\n", cnt);
			MY_CONCAT(idmef_file_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_analyzer_to_string(idmef_analyzer_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "analyzerid: ");
	MY_CONCAT(to_string_uint64,
		  idmef_analyzer_get_analyzerid(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_string_t *field;

		field = idmef_analyzer_get_manufacturer(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "manufacturer: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_analyzer_get_model(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "model: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_analyzer_get_version(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "version: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_analyzer_get_class(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "class: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_analyzer_get_ostype(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "ostype: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_analyzer_get_osversion(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "osversion: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_node_t *field;

		field = idmef_analyzer_get_node(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "node:\n");
			MY_CONCAT(idmef_node_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_process_t *field;

		field = idmef_analyzer_get_process(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "process:\n");
			MY_CONCAT(idmef_process_to_string, field, buffer, size, offset);
		}
	}	

	indent -= 8;

	return offset;
}

int	idmef_alertident_to_string(idmef_alertident_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "alertident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_alertident_get_alertident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "analyzerid: ");
	MY_CONCAT(to_string_uint64,
		  idmef_alertident_get_analyzerid(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	indent -= 8;

	return offset;
}

int	idmef_impact_to_string(idmef_impact_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		int i = idmef_impact_get_severity(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "severity: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_impact_severity_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		int i = idmef_impact_get_completion(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "completion: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_impact_completion_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		int i = idmef_impact_get_type(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "type: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_impact_type_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_impact_get_description(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "description: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_action_to_string(idmef_action_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		int i = idmef_action_get_category(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "category: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_action_category_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	{
		idmef_string_t *field;

		field = idmef_action_get_description(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "description: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_confidence_to_string(idmef_confidence_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		int i = idmef_confidence_get_rating(ptr);

		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, "rating: ");
		MY_SNPRINTF(buffer, size, offset, "%s (%d)", idmef_confidence_rating_to_string(i), i);
		MY_SNPRINTF(buffer, size, offset, "\n");
        }

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "confidence: ");
	MY_CONCAT(to_string_float,
		  idmef_confidence_get_confidence(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	indent -= 8;

	return offset;
}

int	idmef_assessment_to_string(idmef_assessment_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_impact_t *field;

		field = idmef_assessment_get_impact(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "impact:\n");
			MY_CONCAT(idmef_impact_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_action_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_assessment_get_next_action(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "action(%d):\n", cnt);
			MY_CONCAT(idmef_action_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	{
		idmef_confidence_t *field;

		field = idmef_assessment_get_confidence(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "confidence:\n");
			MY_CONCAT(idmef_confidence_to_string, field, buffer, size, offset);
		}
	}	

	indent -= 8;

	return offset;
}

int	idmef_tool_alert_to_string(idmef_tool_alert_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_string_t *field;

		field = idmef_tool_alert_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_string_t *field;

		field = idmef_tool_alert_get_command(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "command: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_alertident_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_tool_alert_get_next_alertident(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "alertident(%d):\n", cnt);
			MY_CONCAT(idmef_alertident_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_correlation_alert_to_string(idmef_correlation_alert_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_string_t *field;

		field = idmef_correlation_alert_get_name(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "name: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_alertident_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_correlation_alert_get_next_alertident(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "alertident(%d):\n", cnt);
			MY_CONCAT(idmef_alertident_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_overflow_alert_to_string(idmef_overflow_alert_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_string_t *field;

		field = idmef_overflow_alert_get_program(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "program: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "size: ");
	MY_CONCAT(to_string_uint32,
		  idmef_overflow_alert_get_size(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_data_t *field;

		field = idmef_overflow_alert_get_buffer(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "buffer: ");
			MY_CONCAT(to_string_data, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_alert_to_string(idmef_alert_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_alert_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_assessment_t *field;

		field = idmef_alert_get_assessment(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "assessment:\n");
			MY_CONCAT(idmef_assessment_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_analyzer_t *field;

		field = idmef_alert_get_analyzer(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "analyzer:\n");
			MY_CONCAT(idmef_analyzer_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_time_t *field;

		field = idmef_alert_get_create_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "create_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_time_t *field;

		field = idmef_alert_get_detect_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "detect_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_time_t *field;

		field = idmef_alert_get_analyzer_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "analyzer_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_source_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_alert_get_next_source(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "source(%d):\n", cnt);
			MY_CONCAT(idmef_source_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	{
		idmef_target_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_alert_get_next_target(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "target(%d):\n", cnt);
			MY_CONCAT(idmef_target_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	{
		idmef_classification_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_alert_get_next_classification(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "classification(%d):\n", cnt);
			MY_CONCAT(idmef_classification_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	{
		idmef_additional_data_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_alert_get_next_additional_data(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "additional_data(%d):\n", cnt);
			MY_CONCAT(idmef_additional_data_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	switch ( idmef_alert_get_type(ptr) ) {
	case idmef_tool_alert:
		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, ("tool_alert:\n"));
		MY_CONCAT(idmef_tool_alert_to_string,
			  idmef_alert_get_tool_alert(ptr),
			  buffer, size, offset);
		break;
 
	case idmef_correlation_alert:
		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, ("correlation_alert:\n"));
		MY_CONCAT(idmef_correlation_alert_to_string,
			  idmef_alert_get_correlation_alert(ptr),
			  buffer, size, offset);
		break;
 
	case idmef_overflow_alert:
		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, ("overflow_alert:\n"));
		MY_CONCAT(idmef_overflow_alert_to_string,
			  idmef_alert_get_overflow_alert(ptr),
			  buffer, size, offset);
		break;
 
	default:
		break;
	}

	indent -= 8;

	return offset;
}

int	idmef_heartbeat_to_string(idmef_heartbeat_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	MY_CONCAT(to_string_indent, indent, buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "ident: ");
	MY_CONCAT(to_string_uint64,
		  idmef_heartbeat_get_ident(ptr),
		  buffer, size, offset);
	MY_SNPRINTF(buffer, size, offset, "\n");

	{
		idmef_analyzer_t *field;

		field = idmef_heartbeat_get_analyzer(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "analyzer:\n");
			MY_CONCAT(idmef_analyzer_to_string, field, buffer, size, offset);
		}
	}	

	{
		idmef_time_t *field;

		field = idmef_heartbeat_get_create_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "create_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_time_t *field;

		field = idmef_heartbeat_get_analyzer_time(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "analyzer_time: ");
			MY_CONCAT(to_string_time, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	{
		idmef_additional_data_t *elem = NULL;
		int cnt = 0;

		while ( (elem = idmef_heartbeat_get_next_additional_data(ptr, elem)) ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);

			MY_SNPRINTF(buffer, size, offset, "additional_data(%d):\n", cnt);
			MY_CONCAT(idmef_additional_data_to_string, elem, buffer, size, offset);

			cnt++;
		}
	}

	indent -= 8;

	return offset;
}

int	idmef_message_to_string(idmef_message_t *ptr, char *buffer, size_t size)
{
	int offset = 0;

	if ( ! ptr )
		return -1;

	indent += 8;

	{
		idmef_string_t *field;

		field = idmef_message_get_version(ptr);

		if ( field ) {
			MY_CONCAT(to_string_indent, indent, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "version: ");
			MY_CONCAT(to_string_string, field, buffer, size, offset);
			MY_SNPRINTF(buffer, size, offset, "\n");
		}
	}

	switch ( idmef_message_get_type(ptr) ) {
	case idmef_alert_message:
		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, ("alert:\n"));
		MY_CONCAT(idmef_alert_to_string,
			  idmef_message_get_alert(ptr),
			  buffer, size, offset);
		break;
 
	case idmef_heartbeat_message:
		MY_CONCAT(to_string_indent, indent, buffer, size, offset);
		MY_SNPRINTF(buffer, size, offset, ("heartbeat:\n"));
		MY_CONCAT(idmef_heartbeat_to_string,
			  idmef_message_get_heartbeat(ptr),
			  buffer, size, offset);
		break;
 
	default:
		break;
	}

	indent -= 8;

	return offset;
}
